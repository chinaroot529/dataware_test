#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
å­¦éœ¸ç¥å™¨æ•°ä»“ - æƒé™ç³»ç»Ÿç¤ºä¾‹æ•°æ®æ’å…¥è„šæœ¬
"""

import pymysql
import traceback
from datetime import datetime, timedelta

# æ•°æ®åº“è¿æ¥é…ç½®
DB_CONFIG = {
    'host': '10.10.0.117',
    'port': 6033,
    'user': 'root',
    'password': 'Xml123&45!',
    'database': 'data_ware_test',
    'charset': 'utf8mb4',
    'autocommit': True
}

def get_connection():
    """è·å–æ•°æ®åº“è¿æ¥"""
    return pymysql.connect(**DB_CONFIG)

def execute_sql(sql, params=None):
    """æ‰§è¡ŒSQLè¯­å¥"""
    try:
        conn = get_connection()
        cursor = conn.cursor()
        if params:
            cursor.execute(sql, params)
        else:
            cursor.execute(sql)
        result = cursor.fetchall()
        cursor.close()
        conn.close()
        return result
    except Exception as e:
        print(f"SQLæ‰§è¡Œé”™è¯¯: {str(e)}")
        print(f"SQLè¯­å¥: {sql}")
        raise

def insert_organizations():
    """æ’å…¥ç»„ç»‡æ¶æ„æ•°æ®"""
    print("æ­£åœ¨æ’å…¥ç»„ç»‡æ¶æ„æ•°æ®...")
    
    org_data = [
        ('1000', 'åšé›…ä¸­å­¦', 'å­¦æ ¡', None, '1000', 1, None, None, 1),
        ('1100', 'é«˜ä¸­éƒ¨', 'å­¦éƒ¨', '1000', '1000/1100', 2, 'é«˜ä¸­', None, 1),
        ('1110', 'é«˜ä¸€å¹´çº§', 'å¹´çº§', '1100', '1000/1100/1110', 3, 'é«˜ä¸­', 'é«˜ä¸€', 1),
        ('1120', 'é«˜äºŒå¹´çº§', 'å¹´çº§', '1100', '1000/1100/1120', 3, 'é«˜ä¸­', 'é«˜äºŒ', 2),
        ('1130', 'é«˜ä¸‰å¹´çº§', 'å¹´çº§', '1100', '1000/1100/1130', 3, 'é«˜ä¸­', 'é«˜ä¸‰', 3),
        ('1111', 'é«˜ä¸€ä¸€ç­', 'ç­çº§', '1110', '1000/1100/1110/1111', 4, 'é«˜ä¸­', 'é«˜ä¸€', 1),
        ('1112', 'é«˜ä¸€äºŒç­', 'ç­çº§', '1110', '1000/1100/1110/1112', 4, 'é«˜ä¸­', 'é«˜ä¸€', 2),
        ('1113', 'é«˜ä¸€ä¸‰ç­', 'ç­çº§', '1110', '1000/1100/1110/1113', 4, 'é«˜ä¸­', 'é«˜ä¸€', 3),
        ('1121', 'é«˜äºŒä¸€ç­', 'ç­çº§', '1120', '1000/1100/1120/1121', 4, 'é«˜ä¸­', 'é«˜äºŒ', 1),
        ('1122', 'é«˜äºŒäºŒç­', 'ç­çº§', '1120', '1000/1100/1120/1122', 4, 'é«˜ä¸­', 'é«˜äºŒ', 2),
        ('1123', 'é«˜äºŒä¸‰ç­', 'ç­çº§', '1120', '1000/1100/1120/1123', 4, 'é«˜ä¸­', 'é«˜äºŒ', 3),
        ('1131', 'é«˜ä¸‰ä¸€ç­', 'ç­çº§', '1130', '1000/1100/1130/1131', 4, 'é«˜ä¸­', 'é«˜ä¸‰', 1),
        ('1132', 'é«˜ä¸‰äºŒç­', 'ç­çº§', '1130', '1000/1100/1130/1132', 4, 'é«˜ä¸­', 'é«˜ä¸‰', 2),
        ('1133', 'é«˜ä¸‰ä¸‰ç­', 'ç­çº§', '1130', '1000/1100/1130/1133', 4, 'é«˜ä¸­', 'é«˜ä¸‰', 3),
    ]
    
    sql = """INSERT INTO ç»„ç»‡æ ‘ç»´åº¦ (ç»„ç»‡ID, ç»„ç»‡åç§°, ç»„ç»‡ç±»å‹, çˆ¶èŠ‚ç‚¹ID, ç»„ç»‡è·¯å¾„, ç»„ç»‡å±‚çº§, å­¦æ®µ, å¹´çº§, æ’åºå·) 
             VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s)"""
    
    for data in org_data:
        execute_sql(sql, data)
    
    print(f"  âœ“ æ’å…¥äº† {len(org_data)} ä¸ªç»„ç»‡è®°å½•")

def insert_roles():
    """æ’å…¥è§’è‰²æ•°æ®"""
    print("æ­£åœ¨æ’å…¥è§’è‰²æ•°æ®...")
    
    role_data = [
        ('R001', 'ç³»ç»Ÿç®¡ç†å‘˜', 'ç³»ç»Ÿè§’è‰²', 'æ‹¥æœ‰ç³»ç»Ÿæœ€é«˜æƒé™', True, 9),
        ('R002', 'æ ¡é•¿', 'ä¸šåŠ¡è§’è‰²', 'å­¦æ ¡ç®¡ç†è€…ï¼Œæ‹¥æœ‰å­¦æ ¡çº§åˆ«æƒé™', True, 8),
        ('R003', 'å­¦éƒ¨ä¸»ä»»', 'ä¸šåŠ¡è§’è‰²', 'å­¦éƒ¨ç®¡ç†è€…ï¼Œæ‹¥æœ‰å­¦éƒ¨çº§åˆ«æƒé™', True, 7),
        ('R004', 'å¹´çº§ä¸»ä»»', 'ä¸šåŠ¡è§’è‰²', 'å¹´çº§ç®¡ç†è€…ï¼Œæ‹¥æœ‰å¹´çº§çº§åˆ«æƒé™', True, 6),
        ('R005', 'ç­ä¸»ä»»', 'ä¸šåŠ¡è§’è‰²', 'ç­çº§ç®¡ç†è€…ï¼Œæ‹¥æœ‰ç­çº§çº§åˆ«æƒé™', True, 5),
        ('R006', 'ä»»è¯¾æ•™å¸ˆ', 'ä¸šåŠ¡è§’è‰²', 'æ™®é€šä»»è¯¾æ•™å¸ˆ', True, 4),
        ('R007', 'ä»£è¯¾æ•™å¸ˆ', 'ä¸šåŠ¡è§’è‰²', 'ä¸´æ—¶ä»£è¯¾æ•™å¸ˆ', True, 3),
        ('R008', 'å®ä¹ æ•™å¸ˆ', 'ä¸šåŠ¡è§’è‰²', 'å®ä¹ æœŸæ•™å¸ˆ', True, 2),
        ('R009', 'å­¦ç”Ÿ', 'ä¸šåŠ¡è§’è‰²', 'å­¦ç”Ÿç”¨æˆ·', True, 1),
    ]
    
    sql = """INSERT INTO è§’è‰²å®šä¹‰è¡¨ (è§’è‰²ID, è§’è‰²åç§°, è§’è‰²ç±»å‹, è§’è‰²æè¿°, æ˜¯å¦ç³»ç»Ÿå†…ç½®, æƒé™çº§åˆ«) 
             VALUES (%s, %s, %s, %s, %s, %s)"""
    
    for data in role_data:
        execute_sql(sql, data)
    
    print(f"  âœ“ æ’å…¥äº† {len(role_data)} ä¸ªè§’è‰²è®°å½•")

def insert_permissions():
    """æ’å…¥æƒé™æ•°æ®"""
    print("æ­£åœ¨æ’å…¥æƒé™æ•°æ®...")
    
    permission_data = [
        ('P001', 'æŸ¥çœ‹é¢˜ç›®', 'æ•°æ®æƒé™', 'é¢˜ç›®', 'æŸ¥çœ‹', 'question:view', 'æŸ¥çœ‹é¢˜ç›®å†…å®¹å’Œä¿¡æ¯', True),
        ('P002', 'ç¼–è¾‘é¢˜ç›®', 'æ•°æ®æƒé™', 'é¢˜ç›®', 'ç¼–è¾‘', 'question:edit', 'ç¼–è¾‘é¢˜ç›®å†…å®¹', True),
        ('P003', 'åˆ é™¤é¢˜ç›®', 'æ•°æ®æƒé™', 'é¢˜ç›®', 'åˆ é™¤', 'question:delete', 'åˆ é™¤é¢˜ç›®', True),
        ('P004', 'åˆ†äº«é¢˜ç›®', 'æ•°æ®æƒé™', 'é¢˜ç›®', 'åˆ†äº«', 'question:share', 'åˆ†äº«é¢˜ç›®ç»™å…¶ä»–ç”¨æˆ·', True),
        ('P005', 'é¢˜ç›®æ‰€æœ‰æƒ', 'æ•°æ®æƒé™', 'é¢˜ç›®', 'ç®¡ç†', 'question:own', 'é¢˜ç›®æ‰€æœ‰æƒï¼Œå¯è¿›è¡Œæ‰€æœ‰æ“ä½œ', True),
        ('P011', 'æŸ¥çœ‹è¯•å·', 'æ•°æ®æƒé™', 'è¯•å·', 'æŸ¥çœ‹', 'paper:view', 'æŸ¥çœ‹è¯•å·å†…å®¹', True),
        ('P012', 'ç¼–è¾‘è¯•å·', 'æ•°æ®æƒé™', 'è¯•å·', 'ç¼–è¾‘', 'paper:edit', 'ç¼–è¾‘è¯•å·å†…å®¹', True),
        ('P013', 'åˆ é™¤è¯•å·', 'æ•°æ®æƒé™', 'è¯•å·', 'åˆ é™¤', 'paper:delete', 'åˆ é™¤è¯•å·', True),
        ('P021', 'æŸ¥çœ‹æˆç»©', 'æ•°æ®æƒé™', 'æˆç»©', 'æŸ¥çœ‹', 'score:view', 'æŸ¥çœ‹å­¦ç”Ÿæˆç»©', True),
        ('P022', 'ç¼–è¾‘æˆç»©', 'æ•°æ®æƒé™', 'æˆç»©', 'ç¼–è¾‘', 'score:edit', 'ä¿®æ”¹å­¦ç”Ÿæˆç»©', True),
        ('P031', 'æŸ¥çœ‹å­¦ç”Ÿä¿¡æ¯', 'æ•°æ®æƒé™', 'å­¦ç”Ÿ', 'æŸ¥çœ‹', 'student:view', 'æŸ¥çœ‹å­¦ç”ŸåŸºæœ¬ä¿¡æ¯', True),
        ('P032', 'ç®¡ç†å­¦ç”Ÿ', 'æ•°æ®æƒé™', 'å­¦ç”Ÿ', 'ç®¡ç†', 'student:manage', 'ç®¡ç†å­¦ç”Ÿä¿¡æ¯', True),
        ('P041', 'æŸ¥çœ‹ç­çº§ä¿¡æ¯', 'æ•°æ®æƒé™', 'ç­çº§', 'æŸ¥çœ‹', 'class:view', 'æŸ¥çœ‹ç­çº§ä¿¡æ¯', True),
        ('P042', 'ç®¡ç†ç­çº§', 'æ•°æ®æƒé™', 'ç­çº§', 'ç®¡ç†', 'class:manage', 'ç®¡ç†ç­çº§ä¿¡æ¯', True),
    ]
    
    sql = """INSERT INTO æƒé™å®šä¹‰è¡¨ (æƒé™ID, æƒé™åç§°, æƒé™ç±»å‹, èµ„æºç±»å‹, æ“ä½œç±»å‹, æƒé™ä»£ç , æƒé™æè¿°, æ˜¯å¦ç³»ç»Ÿå†…ç½®) 
             VALUES (%s, %s, %s, %s, %s, %s, %s, %s)"""
    
    for data in permission_data:
        execute_sql(sql, data)
    
    print(f"  âœ“ æ’å…¥äº† {len(permission_data)} ä¸ªæƒé™è®°å½•")

def insert_users():
    """æ’å…¥ç”¨æˆ·æ•°æ®"""
    print("æ­£åœ¨æ’å…¥ç”¨æˆ·æ•°æ®...")
    
    user_data = [
        ('U001', 'ç®¡ç†å‘˜', 'admin', 'ç³»ç»Ÿç®¡ç†å‘˜', 'ç”·', None, None, 'A001', 'æ­£å¸¸'),
        ('U002', 'æ•™å¸ˆ', 'principal', 'å¼ æ ¡é•¿', 'ç”·', None, 'æ ¡é•¿', 'P001', 'æ­£å¸¸'),
        ('U003', 'æ•™å¸ˆ', 'dept_director', 'æä¸»ä»»', 'å¥³', None, 'å­¦éƒ¨ä¸»ä»»', 'D001', 'æ­£å¸¸'),
        ('U004', 'æ•™å¸ˆ', 'grade1_director', 'ç‹ä¸»ä»»', 'ç”·', None, 'å¹´çº§ä¸»ä»»', 'G001', 'æ­£å¸¸'),
        ('U005', 'æ•™å¸ˆ', 'grade2_director', 'èµµä¸»ä»»', 'å¥³', None, 'å¹´çº§ä¸»ä»»', 'G002', 'æ­£å¸¸'),
        ('U006', 'æ•™å¸ˆ', 'class1_teacher', 'åˆ˜è€å¸ˆ', 'å¥³', 'è¯­æ–‡', 'é«˜çº§æ•™å¸ˆ', 'T001', 'æ­£å¸¸'),
        ('U007', 'æ•™å¸ˆ', 'class2_teacher', 'é™ˆè€å¸ˆ', 'ç”·', 'æ•°å­¦', 'ä¸­çº§æ•™å¸ˆ', 'T002', 'æ­£å¸¸'),
        ('U008', 'æ•™å¸ˆ', 'math_teacher', 'å­™è€å¸ˆ', 'å¥³', 'æ•°å­¦', 'é«˜çº§æ•™å¸ˆ', 'T003', 'æ­£å¸¸'),
        ('U009', 'æ•™å¸ˆ', 'english_teacher', 'å‘¨è€å¸ˆ', 'ç”·', 'è‹±è¯­', 'ä¸­çº§æ•™å¸ˆ', 'T004', 'æ­£å¸¸'),
        ('U010', 'æ•™å¸ˆ', 'substitute_teacher', 'å´è€å¸ˆ', 'å¥³', 'ç‰©ç†', 'åˆçº§æ•™å¸ˆ', 'T005', 'æ­£å¸¸'),
        ('U011', 'å­¦ç”Ÿ', 'student1', 'å°æ˜', 'ç”·', None, None, None, 'æ­£å¸¸'),
        ('U012', 'å­¦ç”Ÿ', 'student2', 'å°çº¢', 'å¥³', None, None, None, 'æ­£å¸¸'),
    ]
    
    sql = """INSERT INTO ä¸ªäººç»´åº¦ (ç”¨æˆ·ID, ç”¨æˆ·ç±»å‹, ç”¨æˆ·å, çœŸå®å§“å, æ€§åˆ«, ä¸»è¦å­¦ç§‘, èŒç§°, å·¥å·, è´¦æˆ·çŠ¶æ€) 
             VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s)"""
    
    for data in user_data:
        execute_sql(sql, data)
    
    print(f"  âœ“ æ’å…¥äº† {len(user_data)} ä¸ªç”¨æˆ·è®°å½•")

def insert_role_permissions():
    """æ’å…¥è§’è‰²æƒé™å…³ç³»"""
    print("æ­£åœ¨æ’å…¥è§’è‰²æƒé™å…³ç³»...")
    
    # ç³»ç»Ÿç®¡ç†å‘˜æ‹¥æœ‰æ‰€æœ‰æƒé™
    admin_permissions = ['P001', 'P002', 'P003', 'P004', 'P005', 'P011', 'P012', 'P013', 
                        'P021', 'P022', 'P031', 'P032', 'P041', 'P042']
    
    # ä»»è¯¾æ•™å¸ˆåŸºç¡€æƒé™
    teacher_permissions = ['P001', 'P002', 'P004', 'P011', 'P012', 'P021', 'P031']
    
    # ç­ä¸»ä»»æƒé™
    head_teacher_permissions = ['P001', 'P002', 'P004', 'P011', 'P012', 'P021', 'P022', 'P031', 'P032', 'P041', 'P042']
    
    role_permission_data = []
    
    # ç³»ç»Ÿç®¡ç†å‘˜æƒé™
    for i, perm in enumerate(admin_permissions):
        role_permission_data.append((f'RP{i+1:03d}', 'R001', perm, True))
    
    # ä»»è¯¾æ•™å¸ˆæƒé™
    for i, perm in enumerate(teacher_permissions):
        role_permission_data.append((f'RP{i+100:03d}', 'R006', perm, True))
    
    # ç­ä¸»ä»»æƒé™
    for i, perm in enumerate(head_teacher_permissions):
        role_permission_data.append((f'RP{i+200:03d}', 'R005', perm, True))
    
    sql = """INSERT INTO è§’è‰²æƒé™æ¡¥æ¥è¡¨ (æ¡¥æ¥ID, è§’è‰²ID, æƒé™ID, æ˜¯å¦ç»§æ‰¿) 
             VALUES (%s, %s, %s, %s)"""
    
    for data in role_permission_data:
        execute_sql(sql, data)
    
    print(f"  âœ“ æ’å…¥äº† {len(role_permission_data)} ä¸ªè§’è‰²æƒé™å…³ç³»")

def insert_user_org_relations():
    """æ’å…¥ç”¨æˆ·ç»„ç»‡å…³ç³»"""
    print("æ­£åœ¨æ’å…¥ç”¨æˆ·ç»„ç»‡å…³ç³»...")
    
    relation_data = [
        ('UR001', 'U001', '1000', '1000', 'ä¸»è¦å½’å±', 'R001', True),
        ('UR002', 'U002', '1000', '1000', 'ä¸»è¦å½’å±', 'R002', True),
        ('UR003', 'U003', '1100', '1000/1100', 'ä¸»è¦å½’å±', 'R003', True),
        ('UR004', 'U004', '1110', '1000/1100/1110', 'ä¸»è¦å½’å±', 'R004', True),
        ('UR005', 'U005', '1120', '1000/1100/1120', 'ä¸»è¦å½’å±', 'R004', True),
        ('UR006', 'U006', '1111', '1000/1100/1110/1111', 'ä¸»è¦å½’å±', 'R005', True),
        ('UR007', 'U007', '1112', '1000/1100/1110/1112', 'ä¸»è¦å½’å±', 'R005', True),
        ('UR008', 'U008', '1112', '1000/1100/1110/1112', 'ä»»è¯¾å…³ç³»', 'R006', True),
        ('UR009', 'U008', '1123', '1000/1100/1120/1123', 'ä»»è¯¾å…³ç³»', 'R006', False),
        ('UR010', 'U009', '1111', '1000/1100/1110/1111', 'ä»»è¯¾å…³ç³»', 'R006', True),
        ('UR011', 'U009', '1113', '1000/1100/1110/1113', 'ä»»è¯¾å…³ç³»', 'R006', False),
        ('UR012', 'U010', '1121', '1000/1100/1120/1121', 'ä¸´æ—¶æƒé™', 'R007', True),
        ('UR013', 'U011', '1111', '1000/1100/1110/1111', 'ä¸»è¦å½’å±', 'R009', True),
        ('UR014', 'U012', '1112', '1000/1100/1110/1112', 'ä¸»è¦å½’å±', 'R009', True),
    ]
    
    sql = """INSERT INTO ç”¨æˆ·ç»„ç»‡å…³ç³»è¡¨ (å…³ç³»ID, ç”¨æˆ·ID, ç»„ç»‡ID, ç»„ç»‡è·¯å¾„, å…³ç³»ç±»å‹, è§’è‰²ID, æ˜¯å¦ä¸»è¦è§’è‰²) 
             VALUES (%s, %s, %s, %s, %s, %s, %s)"""
    
    for data in relation_data:
        execute_sql(sql, data)
    
    # è®¾ç½®ä»£è¯¾æ•™å¸ˆä¸´æ—¶æƒé™å¤±æ•ˆæ—¶é—´
    expire_sql = """UPDATE ç”¨æˆ·ç»„ç»‡å…³ç³»è¡¨ SET å¤±æ•ˆæ—¶é—´ = %s WHERE å…³ç³»ID = 'UR012'"""
    expire_time = datetime.now() + timedelta(days=90)  # 3ä¸ªæœˆåè¿‡æœŸ
    execute_sql(expire_sql, (expire_time,))
    
    print(f"  âœ“ æ’å…¥äº† {len(relation_data)} ä¸ªç”¨æˆ·ç»„ç»‡å…³ç³»")

def insert_sample_acl():
    """æ’å…¥ç¤ºä¾‹ACLæ•°æ®"""
    print("æ­£åœ¨æ’å…¥ç¤ºä¾‹ACLæ•°æ®...")
    
    acl_data = [
        ('ACL001', 'Q001', 'é¢˜ç›®', 'org', '1100', 'æŸ¥çœ‹', '1000/1100', False, 'é»˜è®¤ç»§æ‰¿', 'æ— éœ€ç”³è¯·', 'U006'),
        ('ACL002', 'Q001', 'é¢˜ç›®', 'user', 'U006', 'æ‰€æœ‰æƒ', '1000/1100', True, 'é»˜è®¤ç»§æ‰¿', 'æ— éœ€ç”³è¯·', 'U006'),
        ('ACL003', 'Q002', 'é¢˜ç›®', 'org', '1112', 'æŸ¥çœ‹', '1000/1100/1110/1112', False, 'è·¯å¾„æƒé™', 'æ— éœ€ç”³è¯·', 'U007'),
        ('ACL004', 'Q002', 'é¢˜ç›®', 'user', 'U007', 'æ‰€æœ‰æƒ', '1000/1100/1110/1112', True, 'è·¯å¾„æƒé™', 'æ— éœ€ç”³è¯·', 'U007'),
        ('ACL005', 'Q002', 'é¢˜ç›®', 'user', 'U008', 'æŸ¥çœ‹', '1000/1100/1120/1123', False, 'ç”³è¯·è·å¾—', 'å¾…å®¡æ‰¹', 'U007'),
    ]
    
    sql = """INSERT INTO é¢˜ç›®æ“ä½œACLè¡¨ (ACL_ID, èµ„æºID, èµ„æºç±»å‹, æˆæƒå¯¹è±¡ç±»å‹, æˆæƒå¯¹è±¡ID, æƒé™ç±»å‹, æƒé™èŒƒå›´, æ˜¯å¦å¯ç¼–è¾‘åŸèµ„æº, æƒé™æ¥æº, ç”³è¯·çŠ¶æ€, åˆ›å»ºè€…ID) 
             VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)"""
    
    for data in acl_data:
        execute_sql(sql, data)
    
    print(f"  âœ“ æ’å…¥äº† {len(acl_data)} ä¸ªACLè®°å½•")

def validate_data():
    """éªŒè¯æ•°æ®æ’å…¥ç»“æœ"""
    print("æ­£åœ¨éªŒè¯æ•°æ®æ’å…¥ç»“æœ...")
    
    validation_queries = [
        ("ç»„ç»‡æ•°é‡", "SELECT COUNT(*) FROM ç»„ç»‡æ ‘ç»´åº¦"),
        ("è§’è‰²æ•°é‡", "SELECT COUNT(*) FROM è§’è‰²å®šä¹‰è¡¨"),
        ("æƒé™æ•°é‡", "SELECT COUNT(*) FROM æƒé™å®šä¹‰è¡¨"),
        ("ç”¨æˆ·æ•°é‡", "SELECT COUNT(*) FROM ä¸ªäººç»´åº¦"),
        ("è§’è‰²æƒé™å…³ç³»", "SELECT COUNT(*) FROM è§’è‰²æƒé™æ¡¥æ¥è¡¨"),
        ("ç”¨æˆ·ç»„ç»‡å…³ç³»", "SELECT COUNT(*) FROM ç”¨æˆ·ç»„ç»‡å…³ç³»è¡¨"),
        ("ACLè®°å½•", "SELECT COUNT(*) FROM é¢˜ç›®æ“ä½œACLè¡¨"),
    ]
    
    for desc, sql in validation_queries:
        result = execute_sql(sql)
        count = result[0][0] if result else 0
        print(f"  âœ“ {desc}: {count}")

def main():
    """ä¸»å‡½æ•°"""
    print("=" * 60)
    print("ğŸ“Š æƒé™ç³»ç»Ÿç¤ºä¾‹æ•°æ®æ’å…¥è„šæœ¬")
    print("=" * 60)
    print(f"å¼€å§‹æ—¶é—´: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}")
    print()
    
    try:
        insert_organizations()
        insert_roles()
        insert_permissions()
        insert_users()
        insert_role_permissions()
        insert_user_org_relations()
        insert_sample_acl()
        
        print()
        validate_data()
        
        print()
        print("ğŸ‰ ç¤ºä¾‹æ•°æ®æ’å…¥å®Œæˆï¼")
        print("=" * 60)
        
    except Exception as e:
        print(f"âŒ æ•°æ®æ’å…¥å¤±è´¥: {str(e)}")
        traceback.print_exc()

if __name__ == "__main__":
    main() 